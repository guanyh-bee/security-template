<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.vue3.mapper.MyUserMapper">

    <resultMap id="resultMap" type="com.example.vue3.entity.MyUser">
        <id property="myUserId" column="my_user_id"></id>
        <result property="username" column="username"></result>
        <result property="password" column="password"></result>
        <result property="accountNonExpired" column="account_non_expired"></result>
        <result property="accountNonLocked" column="account_non_locked"></result>
        <result property="credentialsNonExpired" column="credentials_non_expired"></result>
        <result property="enabled" column="enabled"></result>
        <collection property="listAuthorities" ofType="string">
            <result column="authority_name"></result>
        </collection>

    </resultMap>

    <select id="getUserDetail" resultMap="resultMap" >
        select my_user_id
             , username
             , password
             , account_non_expired
             , account_non_locked
             , credentials_non_expired
             , authority_name
             , enabled
        from my_user
                 join user_role ur on my_user.my_user_id = ur.user_id
                 join role_authority ra on ur.role_id = ra.role_id
                 join authority a on a.id = ra.authority_id
        where username = #{username}
    </select>

</mapper>
