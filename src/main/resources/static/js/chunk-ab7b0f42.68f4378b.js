(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ab7b0f42"],{"284b":function(t,e,a){"use strict";a("d3b7");var s=a("bc3a"),o=a.n(s),i=a("a18c"),n=a("5c96"),l=o.a.create({baseURL:"http://localhost:8080"});l.interceptors.request.use((function(t){var e=localStorage.getItem("token");return e?t.headers.token=e:i["a"].push("/login"),t}),(function(t){return Promise.reject(t)})),l.interceptors.response.use((function(t){if(t.data.code)switch(t.data.code){case 4004:window.localStorage.removeItem("token"),window.localStorage.removeItem("info"),i["a"].push("/login").catch((function(t){console.log(t)}));break;case 4003:Object(n["Message"])({showClose:!0,message:"权限不足",type:"warning"});break}return t}),(function(t){return Promise.reject(t.response.status)})),e["a"]=l},"8fbe":function(t,e,a){"use strict";a("aa0c")},aa0c:function(t,e,a){},fa33:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"my_task"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,"row-class-name":t.tableRowClassName}},[a("el-table-column",{attrs:{label:"序号",type:"index"}}),a("el-table-column",{attrs:{label:"任务名称",align:"center",prop:"taskName"}}),a("el-table-column",{attrs:{label:"任务创建时间",align:"center",prop:"taskCreatedTime"}}),a("el-table-column",{attrs:{label:"任务截至时间",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.warning?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"仅剩不到一天到期!",placement:"bottom"}},[a("span",[t._v(t._s(e.row.taskUntilTime)+" "),a("i",{staticClass:"el-icon-warning"})])]):a("span",[t._v(t._s(e.row.taskUntilTime))])]}}])}),a("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{round:"",size:"middle",type:e.row.expired?"danger":"primary",disabled:e.row.expired},on:{click:function(a){return t.handleEdit(e.row)}}},[t._v(t._s(e.row.expired?"任务已过期":"去完成任务")+" ")])]}}])})],1),a("el-dialog",{attrs:{title:"任务详情",visible:t.dialogFormVisible,center:"",width:"30%"},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-form",{ref:"taskResultForm",attrs:{model:t.taskResult}},[t._l(t.currentRow.items,(function(e,s){return[a("div",{key:e.taskItemId+s},[a("el-form-item",{attrs:{label:"是否有"+e.taskItemName}},[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(e){return t.handleNo(s)}},model:{value:t.taskResult.commitData[s].hasItem,callback:function(e){t.$set(t.taskResult.commitData[s],"hasItem",e)},expression:"taskResult.commitData[index].hasItem"}})],1),e.taskItemNumber?a("el-form-item",{attrs:{label:e.taskItemName+"数量",prop:"commitData["+s+"].itemNum",rules:t.taskResult.commitData[s].hasItem?[{required:!0,message:"请输入数量",trigger:"blur"}]:[]}},[a("el-input",{attrs:{disabled:!t.taskResult.commitData[s].hasItem,type:"number",min:0},model:{value:t.taskResult.commitData[s].itemNum,callback:function(e){t.$set(t.taskResult.commitData[s],"itemNum",t._n(e))},expression:"taskResult.commitData[index].itemNum"}},[a("template",{slot:"append"},[t._v(t._s(e.taskItemUnit))])],2)],1):t._e(),a("el-divider")],1)]}))],2),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.confirmTask}},[t._v("确 定")])],1)],1)],1)},o=[],i=a("284b"),n={data:function(){return{tableData:[],dialogFormVisible:!1,taskResult:{commitData:[]},currentRow:{}}},methods:{tableRowClassName:function(t){var e=t.row;return e.expried?"danger-row":e.warning?"warning-row":void 0},handleEdit:function(t){this.currentRow=t,this.initData(),this.dialogFormVisible=!0,console.log(t)},getTask:function(){var t=this;i["a"].get("/task/myTask").then((function(e){t.tableData=e.data.data})).catch((function(t){console.log(t)}))},initData:function(){this.taskResult.commitData=[];for(var t=0;t<this.currentRow.items.length;t++)this.taskResult.commitData.push({hasItem:!1,itemNum:null,taskItemId:this.currentRow.items[t].taskItemId,taskResultId:this.currentRow.taskResultId})},confirmTask:function(){var t=this;this.$refs["taskResultForm"].validate((function(e){if(!e)return console.log("error submit!!"),console.log(t.taskResult.commitData),!1;i["a"].post("/task/commitMyTask",t.taskResult).catch((function(t){console.log(t)})).then((function(e){200==e.data.code?(t.$message({message:"提交成功",type:"success"}),t.dialogFormVisible=!1,t.getTask()):t.$message.error(e.data.message)}))}))},handleNo:function(t){this.taskResult.commitData[t].hasItem||(this.taskResult.commitData[t].itemNum=null)}},created:function(){this.getTask()}},l=n,r=(a("8fbe"),a("2877")),c=Object(r["a"])(l,s,o,!1,null,"8805a986",null);e["default"]=c.exports}}]);
//# sourceMappingURL=chunk-ab7b0f42.68f4378b.js.map