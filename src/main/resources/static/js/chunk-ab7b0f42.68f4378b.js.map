{"version":3,"sources":["webpack:///./src/request/request.js","webpack:///./src/components/task/MyTask.vue?fdc0","webpack:///./src/components/task/MyTask.vue?b5e2","webpack:///src/components/task/MyTask.vue","webpack:///./src/components/task/MyTask.vue?4842","webpack:///./src/components/task/MyTask.vue?9772"],"names":["instance","axios","create","baseURL","interceptors","request","use","config","token","localStorage","getItem","headers","router","push","err","Promise","reject","response","data","code","window","removeItem","catch","e","console","log","Message","showClose","message","type","error","status","render","_vm","this","_h","$createElement","_c","_self","staticClass","staticStyle","attrs","tableData","tableRowClassName","scopedSlots","_u","key","fn","scope","row","_v","_s","taskUntilTime","expired","on","$event","handleEdit","dialogFormVisible","ref","taskResult","_l","currentRow","item","index","taskItemId","taskItemName","handleNo","model","value","commitData","callback","$$v","$set","expression","hasItem","required","trigger","_n","slot","taskItemUnit","_e","confirmTask","staticRenderFns","methods","initData","getTask","$refs","validate","valid","itemNum","created","component"],"mappings":"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","file":"js/chunk-ab7b0f42.68f4378b.js","sourcesContent":["import axios from \"axios\";\nimport router from \"@/router\";\nimport { Message } from \"element-ui\"; //引入axios\n\nlet instance = axios.create({\n  baseURL:  \"http://localhost:8080\",\n});\n//http://localhost:8080\ninstance.interceptors.request.use(\n  (config) => {\n    const token = localStorage.getItem(\"token\");\n    if (token) {\n      // 判断是否存在token，如果存在的话，则每个http header都加上token\n      config.headers.token = token; //请求头加上token\n    } else {\n      router.push(\"/login\");\n    }\n    return config;\n  },\n  (err) => {\n    return Promise.reject(err);\n  }\n);\n\ninstance.interceptors.response.use(\n  (response) => {\n    //拦截响应，做统一处理\n    if (response.data.code) {\n      switch (response.data.code) {\n        case 4004:\n          window.localStorage.removeItem(\"token\");\n          window.localStorage.removeItem(\"info\");\n          router.push(\"/login\").catch((e) => {\n            console.log(e);\n          });\n          break;\n\n        case 4003:\n          Message({\n            showClose: true,\n            message: \"权限不足\",\n            type: \"warning\",\n          });\n          break;\n      }\n    }\n    return response;\n  },\n  //接口错误状态处理，也就是说无响应时的处理\n  (error) => {\n    return Promise.reject(error.response.status); // 返回接口返回的错误信息\n  }\n);\nexport default instance;\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MyTask.vue?vue&type=style&index=0&id=8805a986&scoped=true&lang=less&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"my_task\"},[_c('el-table',{staticStyle:{\"width\":\"100%\"},attrs:{\"data\":_vm.tableData,\"row-class-name\":_vm.tableRowClassName}},[_c('el-table-column',{attrs:{\"label\":\"序号\",\"type\":\"index\"}}),_c('el-table-column',{attrs:{\"label\":\"任务名称\",\"align\":\"center\",\"prop\":\"taskName\"}}),_c('el-table-column',{attrs:{\"label\":\"任务创建时间\",\"align\":\"center\",\"prop\":\"taskCreatedTime\"}}),_c('el-table-column',{attrs:{\"label\":\"任务截至时间\",\"align\":\"center\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [(scope.row.warning)?_c('el-tooltip',{staticClass:\"item\",attrs:{\"effect\":\"dark\",\"content\":\"仅剩不到一天到期!\",\"placement\":\"bottom\"}},[_c('span',[_vm._v(_vm._s(scope.row.taskUntilTime)+\" \"),_c('i',{staticClass:\"el-icon-warning\"})])]):_c('span',[_vm._v(_vm._s(scope.row.taskUntilTime))])]}}])}),_c('el-table-column',{attrs:{\"align\":\"center\",\"label\":\"操作\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return [_c('el-button',{attrs:{\"round\":\"\",\"size\":\"middle\",\"type\":scope.row.expired?'danger':'primary',\"disabled\":scope.row.expired},on:{\"click\":function($event){return _vm.handleEdit(scope.row)}}},[_vm._v(_vm._s(scope.row.expired ? '任务已过期' : '去完成任务')+\" \")])]}}])})],1),_c('el-dialog',{attrs:{\"title\":\"任务详情\",\"visible\":_vm.dialogFormVisible,\"center\":\"\",\"width\":\"30%\"},on:{\"update:visible\":function($event){_vm.dialogFormVisible=$event}}},[_c('el-form',{ref:\"taskResultForm\",attrs:{\"model\":_vm.taskResult}},[_vm._l((_vm.currentRow.items),function(item,index){return [_c('div',{key:item.taskItemId+index},[_c('el-form-item',{attrs:{\"label\":'是否有' + item.taskItemName}},[_c('el-switch',{attrs:{\"active-color\":\"#13ce66\",\"inactive-color\":\"#ff4949\"},on:{\"change\":function($event){return _vm.handleNo(index)}},model:{value:(_vm.taskResult.commitData[index].hasItem),callback:function ($$v) {_vm.$set(_vm.taskResult.commitData[index], \"hasItem\", $$v)},expression:\"taskResult.commitData[index].hasItem\"}})],1),(item.taskItemNumber)?_c('el-form-item',{attrs:{\"label\":item.taskItemName + '数量',\"prop\":'commitData['+index+'].itemNum',\"rules\":_vm.taskResult.commitData[index].hasItem? [\n          { required: true, message: '请输入数量', trigger: 'blur' }\n        ]:[]}},[_c('el-input',{attrs:{\"disabled\":!_vm.taskResult.commitData[index].hasItem,\"type\":\"number\",\"min\":0},model:{value:(_vm.taskResult.commitData[index].itemNum),callback:function ($$v) {_vm.$set(_vm.taskResult.commitData[index], \"itemNum\", _vm._n($$v))},expression:\"taskResult.commitData[index].itemNum\"}},[_c('template',{slot:\"append\"},[_vm._v(_vm._s(item.taskItemUnit))])],2)],1):_vm._e(),_c('el-divider')],1)]})],2),_c('div',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{on:{\"click\":function($event){_vm.dialogFormVisible = false}}},[_vm._v(\"取 消\")]),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.confirmTask}},[_vm._v(\"确 定\")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"my_task\">\n    <el-table :data=\"tableData\"\n              :row-class-name=\"tableRowClassName\"\n              style=\"width: 100%\">\n      <el-table-column label=\"序号\" type=\"index\"></el-table-column>\n      <el-table-column label=\"任务名称\" align=\"center\" prop=\"taskName\">\n      </el-table-column>\n      <el-table-column\n          label=\"任务创建时间\"\n          align=\"center\"\n          prop=\"taskCreatedTime\"\n      >\n      </el-table-column>\n      <el-table-column\n          label=\"任务截至时间\"\n          align=\"center\"\n      >\n        <template slot-scope=\"scope\">\n\n          <el-tooltip  v-if=\"scope.row.warning\" class=\"item\" effect=\"dark\" content=\"仅剩不到一天到期!\" placement=\"bottom\">\n            <span >{{scope.row.taskUntilTime}} <i class=\"el-icon-warning\"></i></span>\n          </el-tooltip>\n\n\n          <span v-else>{{scope.row.taskUntilTime}}</span>\n\n\n\n        </template>\n      </el-table-column>\n      <el-table-column align=\"center\" label=\"操作\">\n        <template slot-scope=\"scope\">\n          <el-button\n              round\n              size=\"middle\"\n              :type=\"scope.row.expired?'danger':'primary'\"\n              :disabled=\"scope.row.expired\"\n              @click=\"handleEdit(scope.row)\"\n          >{{ scope.row.expired ? '任务已过期' : '去完成任务' }}\n          </el-button\n          >\n        </template>\n      </el-table-column>\n    </el-table>\n\n    <el-dialog\n        title=\"任务详情\"\n        :visible.sync=\"dialogFormVisible\"\n        center\n        width=\"30%\"\n    >\n      <el-form :model=\"taskResult\" ref=\"taskResultForm\">\n        <template v-for=\"(item,index) in currentRow.items\">\n\n          <div :key=\"item.taskItemId+index\">\n            <el-form-item\n                :label=\"'是否有' + item.taskItemName\"\n            >\n              <el-switch\n                  v-model=\"taskResult.commitData[index].hasItem\"\n                  active-color=\"#13ce66\"\n                  inactive-color=\"#ff4949\"\n                  @change=\"handleNo(index)\"\n              >\n              </el-switch>\n            </el-form-item>\n\n            <el-form-item\n                :label=\"item.taskItemName + '数量'\"\n                :prop=\"'commitData['+index+'].itemNum'\"\n                :rules=\"taskResult.commitData[index].hasItem? [\n            { required: true, message: '请输入数量', trigger: 'blur' }\n          ]:[]\"\n                v-if=\"item.taskItemNumber\"\n            >\n              <el-input :disabled=\"!taskResult.commitData[index].hasItem\" type=\"number\" :min=\"0\"\n                        v-model.number=\"taskResult.commitData[index].itemNum\"\n\n              >\n                <template slot=\"append\">{{ item.taskItemUnit }}</template>\n              </el-input>\n            </el-form-item>\n            <el-divider></el-divider>\n          </div>\n        </template>\n\n        <!--          <el-form-item  v-for=\"item in currentRow.items\"   :key=\"item.taskItemId\">-->\n        <!--              -->\n\n        <!--          </el-form-item>-->\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"dialogFormVisible = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"confirmTask\">确 定</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport instance from \"@/request/request\";\n\nexport default {\n  data() {\n    return {\n      tableData: [],\n      dialogFormVisible: false,\n      taskResult: {\n        commitData: [],\n      },\n      currentRow: {},\n    };\n  },\n  methods: {\n    tableRowClassName({row}){\n    if (row.expried){\n      return 'danger-row'\n    }else if (row.warning){\n      return 'warning-row'\n    }\n    },\n    handleEdit(row) {\n      this.currentRow = row;\n      this.initData()\n      this.dialogFormVisible = true;\n      console.log(row)\n    },\n    getTask() {\n      instance\n          .get(\"/task/myTask\")\n          .then((res) => {\n            this.tableData = res.data.data;\n          })\n          .catch((err) => {\n            console.log(err);\n          });\n    },\n    initData() {\n      this.taskResult.commitData = []\n      for (let i = 0; i < this.currentRow.items.length; i++) {\n        this.taskResult.commitData.push(\n            {\n              hasItem: false,\n              itemNum: null,\n              taskItemId: this.currentRow.items[i].taskItemId,\n              taskResultId: this.currentRow.taskResultId\n            }\n        )\n      }\n    },\n    confirmTask() {\n\n      this.$refs[\"taskResultForm\"].validate((valid) => {\n        if (valid) {\n          instance\n              .post(\"/task/commitMyTask\", this.taskResult)\n              .catch((err) => {\n                console.log(err);\n              })\n              .then((res) => {\n                if (res.data.code == 200) {\n                  this.$message({\n                    message: \"提交成功\",\n                    type: \"success\",\n                  });\n                  this.dialogFormVisible = false;\n                  this.getTask();\n                } else {\n                  this.$message.error(res.data.message);\n                }\n              });\n        } else {\n          console.log(\"error submit!!\");\n          console.log(this.taskResult.commitData);\n          return false;\n        }\n      });\n    },\n    handleNo(value) {\n\n      if (!this.taskResult.commitData[value].hasItem) {\n        this.taskResult.commitData[value].itemNum = null\n      }\n    }\n  },\n  created() {\n    this.getTask();\n  },\n};\n</script>\n\n<style scoped lang=\"less\">\n.my_task {\n  width: 80%;\n  margin: 0 auto;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MyTask.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MyTask.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./MyTask.vue?vue&type=template&id=8805a986&scoped=true&\"\nimport script from \"./MyTask.vue?vue&type=script&lang=js&\"\nexport * from \"./MyTask.vue?vue&type=script&lang=js&\"\nimport style0 from \"./MyTask.vue?vue&type=style&index=0&id=8805a986&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"8805a986\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}